<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Yrochie V2 - Moteur de recherche avanc√©</title>
  <style>
    body {
      background: #121212;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0; padding: 1rem;
    }
    h1 {
      text-align: center;
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    #searchContainer {
      max-width: 700px;
      margin: 0 auto 1rem;
      position: relative;
    }
    #searchInput {
      width: 100%;
      padding: 1rem;
      font-size: 1.2rem;
      border-radius: 8px;
      border: none;
      outline: none;
      box-sizing: border-box;
    }
    #suggestions {
      background: #222;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      border-radius: 0 0 8px 8px;
      max-height: 150px;
      overflow-y: auto;
      z-index: 100;
      display: none;
    }
    #suggestions div {
      padding: 0.5rem 1rem;
      cursor: pointer;
    }
    #suggestions div:hover {
      background: #3498db;
    }
    #tabs {
      display: flex;
      justify-content: center;
      margin: 1rem 0;
      gap: 1rem;
    }
    .tab {
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: #222;
      user-select: none;
      transition: background 0.3s;
    }
    .tab.active {
      background: #3498db;
    }
    #results {
      max-width: 800px;
      margin: 0 auto;
      text-align: left;
    }
    .result {
      background: #1e1e1e;
      border-radius: 10px;
      margin-bottom: 1rem;
      padding: 1rem;
    }
    .result a {
      color: #4fc3f7;
      font-weight: bold;
      text-decoration: none;
      font-size: 1.1rem;
    }
    .result p {
      margin: 0.5rem 0 0;
      color: #ccc;
    }
    .result img {
      max-width: 100%;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<h1>Yrochie V2 üîé</h1>

<div id="searchContainer">
  <input id="searchInput" type="text" placeholder="Recherche n'importe quoi..." autocomplete="off" />
  <div id="suggestions"></div>
</div>

<div id="tabs">
  <div class="tab active" data-tab="web">Web</div>
  <div class="tab" data-tab="images">Images</div>
  <div class="tab" data-tab="videos">Vid√©os</div>
</div>

<div id="results"></div>

<!-- Typo.js & dictionnaires -->
<script src="https://cdn.jsdelivr.net/npm/typo-js@1.1.0/typo.min.js"></script>
<script>
  let dictionary;
  fetch('https://cdn.jsdelivr.net/npm/typo-js@1.1.0/dictionaries/fr_FR.aff')
    .then(r => r.text())
    .then(affData => {
      fetch('https://cdn.jsdelivr.net/npm/typo-js@1.1.0/dictionaries/fr_FR.dic')
        .then(r => r.text())
        .then(dicData => {
          dictionary = new Typo("fr_FR", affData, dicData, { platform: 'any' });
        });
    });
</script>

<script>
  const searchInput = document.getElementById("searchInput");
  const suggestionsDiv = document.getElementById("suggestions");
  const resultsDiv = document.getElementById("results");
  const tabs = document.querySelectorAll(".tab");
  let activeTab = "web";

  const suggestionWords = [
    "ChatGPT", "Google", "YouTube", "Facebook", "Twitter",
    "OpenAI", "Programmation", "JavaScript", "Python", "HTML",
    "CSS", "Node.js", "Machine Learning", "Deep Learning",
    "Docker", "Kubernetes", "React", "Vue", "Angular",
    "Music", "Films", "Actualit√©s", "Climat", "Sport"
  ];

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      activeTab = tab.dataset.tab;
      if (searchInput.value.trim().length >= 3) {
        doSearch(searchInput.value.trim());
      }
    });
  });

  searchInput.addEventListener("input", () => {
    const val = searchInput.value.trim();
    if (val.length === 0) {
      suggestionsDiv.style.display = "none";
      return;
    }
    const filtered = suggestionWords.filter(word => word.toLowerCase().startsWith(val.toLowerCase()));
    if (filtered.length === 0) {
      suggestionsDiv.style.display = "none";
      return;
    }
    suggestionsDiv.innerHTML = filtered.map(word => `<div>${word}</div>`).join("");
    suggestionsDiv.style.display = "block";
  });

  suggestionsDiv.addEventListener("click", e => {
    if (e.target.tagName === "DIV") {
      searchInput.value = e.target.textContent;
      suggestionsDiv.style.display = "none";
      doSearch(searchInput.value.trim());
    }
  });

  document.addEventListener("click", e => {
    if (!searchInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
      suggestionsDiv.style.display = "none";
    }
  });

  function correctSpelling(word) {
    if (!dictionary) return word;
    if (dictionary.check(word)) return word;
    const suggestions = dictionary.suggest(word);
    if (suggestions.length > 0) return suggestions[0];
    return word;
  }

  searchInput.addEventListener("keydown", e => {
    if (e.key === "Enter") {
      const queryRaw = searchInput.value.trim();
      if (queryRaw.length < 3) {
        resultsDiv.innerHTML = "<p>Tape au moins 3 lettres pour lancer la recherche.</p>";
        return;
      }
      const corrected = correctSpelling(queryRaw);
      if (corrected !== queryRaw) {
        resultsDiv.innerHTML = `<p>Correction orthographique sugg√©r√©e : <b>${corrected}</b></p>`;
      }
      doSearch(corrected);
      suggestionsDiv.style.display = "none";
    }
  });

  function doSearch(query) {
    resultsDiv.innerHTML = "<p>Chargement...</p>";

    const urlLikePattern = /^(https?:\/\/)?([\w\-]+\.)+[\w\-]+(\/[\w\-./?%&=]*)?$/i;
    if (urlLikePattern.test(query)) {
      let urlToGo = query;
      if (!/^https?:\/\//i.test(query)) {
        urlToGo = "https://" + query;
      }
      window.location.href = urlToGo;
      return;
    }

    if (activeTab === "web") {
      searchWeb(query);
    } else if (activeTab === "images") {
      searchImages(query);
    } else if (activeTab === "videos") {
      searchVideos(query);
    }
  }

  async function searchWeb(query) {
    resultsDiv.innerHTML = "<p>Recherche web en cours...</p>";

    try {
      const res = await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&no_redirect=1&no_html=1`);
      const data = await res.json();

      if (!data || (!data.AbstractURL && (!data.RelatedTopics || data.RelatedTopics.length === 0))) {
        resultsDiv.innerHTML = "<p>Aucun r√©sultat trouv√©.</p>";
        return;
      }

      let html = "";

      if (data.AbstractURL && data.AbstractText) {
        html += `
          <div class="result">
            <a href="${data.AbstractURL}" target="_blank" rel="noopener noreferrer">${data.Heading || query}</a>
            <p>${data.AbstractText}</p>
          </div>
        `;
      }

      if (data.RelatedTopics && data.RelatedTopics.length > 0) {
        data.RelatedTopics.slice(0, 10).forEach(topic => {
          if (topic.Topics) {
            topic.Topics.forEach(t => {
              html += createResultHtml(t);
            });
          } else {
            html += createResultHtml(topic);
          }
        });
      }

      resultsDiv.innerHTML = html;

      function createResultHtml(item) {
        if (!item.Text || !item.FirstURL) return "";
        return `
          <div class="result">
            <a href="${item.FirstURL}" target="_blank" rel="noopener noreferrer">${item.Text}</a>
          </div>
        `;
      }

    } catch (err) {
      resultsDiv.innerHTML = "<p>Erreur lors de la recherche web.</p>";
      console.error(err);
    }
  }

  function searchImages(query) {
    resultsDiv.innerHTML = "<p>Recherche d'images en cours...</p>";

    // Images al√©atoires via Unsplash (v√©rifie ta connexion)
    const urls = [
      `https://source.unsplash.com/400x200/?${encodeURIComponent(query)}`,
      `https://source.unsplash.com/400x200/?${encodeURIComponent(query)},nature`,
      `https://source.unsplash.com/400x200/?${encodeURIComponent(query)},tech`,
      `https://source.unsplash.com/400x200/?${encodeURIComponent(query)},art`,
      `https://source.unsplash.com/400x200/?${encodeURIComponent(query)},abstract`
    ];

    let html = "";
    urls.forEach(url => {
      html += `
        <div class="result">
          <a href="${url}" target="_blank" rel="noopener noreferrer">
            <img src="${url}" alt="Image de ${query}" />
          </a>
        </div>
      `;
    });

    resultsDiv.innerHTML = html;
  }

  function searchVideos(query) {
    resultsDiv.innerHTML = "<p>Recherche de vid√©os en cours...</p>";

    const base = `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;

    // Titres dynamiques adapt√©s √† la recherche
    const videoTitles = [
      `Pr√©sentation de ${query}`,
      `Tutoriel ${query}`,
      `D√©couverte de ${query}`,
      `Exemple pratique de ${query}`,
      `Les bases de ${query}`
    ];

    let html = "";
    videoTitles.forEach(title => {
      html += `
        <div class="result">
          <a href="${base}" target="_blank" rel="noopener noreferrer">${title}</a>
        </div>
      `;
    });

    resultsDiv.innerHTML = html;
  }
</script>

</body>
</html>


